<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8" />
    <title>PHP - Excel avec PHP</title>
    <link rel="stylesheet" href="../assets/style.css" />
</head>

<body>
    <header>
        <h1>Excel avec PHP</h1>
        <p>Lecture et écriture de fichiers Excel.</p>
    </header>

    <main>
        <h1>Chapitre 76: Excel avec PHP</h1>

        <h2>1. Introduction</h2>
        <p>
            Manipuler des fichiers Excel en PHP est très utile pour automatiser la génération de rapports, importer ou exporter des données.
            La bibliothèque la plus populaire pour cela est <strong>PhpSpreadsheet</strong>, qui supporte les formats XLSX, XLS, CSV, etc.
        </p>

        <h2>2. Installation de PhpSpreadsheet</h2>
        <p>
            La manière la plus simple est d’utiliser Composer :
        </p>
        <pre><code>composer require phpoffice/phpspreadsheet</code></pre>

        <h2>3. Exemple : création d'un fichier Excel</h2>
        <pre><code>&lt;?php
require 'vendor/autoload.php';

use PhpOffice\PhpSpreadsheet\Spreadsheet;
use PhpOffice\PhpSpreadsheet\Writer\Xlsx;

// Création d'une nouvelle feuille de calcul
$spreadsheet = new Spreadsheet();
$sheet = $spreadsheet->getActiveSheet();

// Ajouter des données dans les cellules
$sheet->setCellValue('A1', 'Nom');
$sheet->setCellValue('B1', 'Email');
$sheet->setCellValue('A2', 'Dupont');
$sheet->setCellValue('B2', 'dupont@example.com');

// Enregistrement du fichier Excel
$writer = new Xlsx($spreadsheet);
$writer->save('exemple.xlsx');

echo "Fichier Excel créé avec succès !";
?&gt;
</code></pre>

        <h2>4. Lecture d'un fichier Excel</h2>
        <pre><code>&lt;?php
require 'vendor/autoload.php';

use PhpOffice\PhpSpreadsheet\IOFactory;

// Charger un fichier Excel existant
$spreadsheet = IOFactory::load('exemple.xlsx');
$sheet = $spreadsheet->getActiveSheet();

// Lire une cellule
$nom = $sheet->getCell('A2')->getValue();
$email = $sheet->getCell('B2')->getValue();

echo "Nom: $nom, Email: $email";
?&gt;
</code></pre>

        <h2>5. Conseils</h2>
        <ul>
            <li>PhpSpreadsheet supporte beaucoup de formats et fonctionnalités avancées.</li>
            <li>Gérez bien les erreurs, surtout lors du chargement de fichiers externes.</li>
            <li>Consultez la documentation officielle pour plus de détails : <a href="https://phpspreadsheet.readthedocs.io/" target="_blank" rel="noopener noreferrer">https://phpspreadsheet.readthedocs.io/</a></li>
        </ul>
    </main>

    <footer>
        <p>
            Guide d'apprentissage PHP &copy; 2025 | Liens utiles : 
            <a href="https://phpspreadsheet.readthedocs.io/" target="_blank" rel="noopener noreferrer">Documentation PhpSpreadsheet</a> | 
            <a href="https://github.com/PHPOffice/PhpSpreadsheet" target="_blank" rel="noopener noreferrer">PhpSpreadsheet sur GitHub</a>
        </p>
    </footer>
</body>

</html>
